
<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1">
    <meta name="author" content="煦涵" />
    <meta name="designer" content="煦涵" />
    <meta name="description" content="崇尚开源，热爱分享，极客精神，持续学习">
    <meta name="keywords" content="FED，前端开发，用户体验，nodejs，webpack，vue，react">
    <meta name="rating" content="general" /> 
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="robots" content="index, follow" />

    <meta id="Copyright" content="Copyright 2015-2017 Fedlab. All Rights Reserved">
    <meta name="format-detection" content="telephone=no">


    <link type="image/x-icon" href="/favicon.ico" rel="icon">
    <link type="image/x-icon" href="/favicon.ico" rel="Shortcut Icon">
    <link type="image/x-icon" href="/favicon.ico" rel="bookmark">
    <link rel="apple-touch-icon-precomposed" href="/touch-translation.png">
    
        <title>煦涵说Babel - FED实验室</title>
    
    <link rel="stylesheet" href="/css/fedlab.css">
</head>


<body>
    
<header class="fedlab-header white">
    <div class="fedlab-header-inner">
        <div class="fedlab-header-logo">
            <a href="/">FEDLAB(前端开发实验室)</a>
        </div>
        <nav class="fedlab-header-nav">
    <ul class="fedlab-header-nav-list">
        <li class="fedlab-header-nav-item current">
            <a href="/">首页</a></li>
        <li class="fedlab-header-nav-item">
            <a href="/content.html">文档</a>
        </li>
        <li class="fedlab-header-nav-item">
            <a href="/about.html">我们</a>
        </li>
    </ul>
</nav>

        <div class="fedlab-header-search">
            <button class="fedlab-header-search-btn icon icon-search" type="button" title="搜索">搜索</button>
            <div class="fedlab-header-search-form">
                <button type="button" class="fedlab-header-search-icon icon icon-search">搜索</button>
                <input type="text" class="fedlab-header-search-text" placeholder="请输入想要搜索的内容">
                <button type="button" class="fedlab-header-search-clear icon icon-clear">关闭</button>
            </div>
        </div>
    </div>
</header>
    
    
<div class="fedlab-main fedlab-article">
    <div class="fedlab-article-details">
        <div class="fedlab-article-con">
            <div class="fedlab-article-con-title">
                <h3 title="煦涵说Babel">煦涵说Babel</h3>
            </div>
            <p class="fedlab-article-con-meta">By <a href="https://github.com/zuojj" target="_blank">煦涵</a> At 2017-09-03 05:00:00</p>
            <div class="fedlab-article-con-banner">
                <img src="http://www.zuojj.com/wp-content/uploads/2017/06/babel.jpg" alt="煦涵说Babel">
            </div>
            <div class="fedlab-article-con-text">
                <div class="content-text">
                <p><a href="http://babeljs.io/" target="_blank" rel="external">Babel</a>，下一代javascript编译器，当前版本 <code>v2.4.0</code> ，它可以处理ES6的所有新语法，并内置了React JSX扩展及Flow类型注解支持，如果对Flow不是很了解可以查看FED实验室微信公众号文章<a href="https://segmentfault.com/a/1190000009639356" target="_blank" rel="external">煦涵说Flow</a>。</p>
<p>Babel与JavaScript技术委员会（TC39）始终保持着高度一致，能够在ECMAScript新特性标准化之前为开发者提供现实可用的转码编译实现，以在ECMAScript规范最后定稿前获得来自世界各地开发者更多的反馈，从而间接推动了javascript的发展以及开发者在项目中尝试使用新技术。因此建议大家开始使用 Babel。</p>
<h2 id="Babel-配置文件-babelrc"><a href="#Babel-配置文件-babelrc" class="headerlink" title="Babel 配置文件 .babelrc"></a>Babel 配置文件 <code>.babelrc</code></h2><p>学习和使用Babel的<strong>第一步</strong>，配置 <code>.babelrc</code> 文件，该文件存放到项目根目录下，用来设置 Babel 的转码规则和插件。基本格式如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"presets"</span>: [],</div><div class="line">  <span class="string">"plugins"</span>: []</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><a href="https://babeljs.io/docs/plugins/#presets" target="_blank" rel="external">presets</a>的规则集如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># replaces es2015, es2016, es2017, latest</span></div><div class="line">$ yarn add babel-preset-env --dev</div><div class="line"></div><div class="line"><span class="comment"># es2015</span></div><div class="line">$ yarn add babel-preset-es2015 --dev</div><div class="line"></div><div class="line"><span class="comment"># es2016</span></div><div class="line">$ yarn add babel-preset-es2016 --dev</div><div class="line"></div><div class="line"><span class="comment"># es2017 </span></div><div class="line">$ yarn add babel-preset-es2017 --dev</div><div class="line"></div><div class="line"><span class="comment"># react</span></div><div class="line">$ yarn add babel-preset-react --dev</div><div class="line"></div><div class="line"><span class="comment"># flow</span></div><div class="line">$ yarn add babel-preset-flow --dev</div><div class="line"></div><div class="line"><span class="comment"># The TC39 categorizes proposals into the following stages:</span></div><div class="line"><span class="comment"># </span></div><div class="line"><span class="comment"># Stage 0 - Strawman: just an idea, possible Babel plugin.</span></div><div class="line"><span class="comment"># Stage 1 - Proposal: this is worth working on.</span></div><div class="line"><span class="comment"># Stage 2 - Draft: initial spec.</span></div><div class="line"><span class="comment"># Stage 3 - Candidate: complete spec and initial browser implementations.</span></div><div class="line"><span class="comment"># Stage 4 - Finished: will be added to the next yearly release.</span></div><div class="line"><span class="comment"># For more information, be sure to check out the current TC39 proposals and its process document.</span></div><div class="line"><span class="comment"># </span></div><div class="line"><span class="comment"># The TC39 stage process is also explained in detail across a few posts by Yehuda Katz (@wycatz) over at thefeedbackloop.xyz: # Stage 0 and 1, Stage 2, Stage 3, and Stage 4 coming soon.</span></div><div class="line"></div><div class="line">$ yarn add babel-preset-stage-x --dev</div></pre></td></tr></table></figure>
<p><a href="https://babeljs.io/docs/plugins/#transform-plugins" target="_blank" rel="external">plugins</a>插件集合很多。</p>
<p>新建一个配置文件 <code>.babelrc</code>，并增加如下代码，以供我们下面调试使用:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 新建配置文件.babelrc，并添加如下内容</span></div><div class="line"><span class="comment"># &#123;</span></div><div class="line"><span class="comment">#   "presets": ["es2015"],</span></div><div class="line"><span class="comment">#   "plugins": []</span></div><div class="line"><span class="comment"># &#125;</span></div><div class="line">$ touch .babelrc</div><div class="line"><span class="comment"># 安装 babel-preset-es2015</span></div><div class="line">$ yarn add babel-preset-es2015 --dev</div></pre></td></tr></table></figure></p>
<h2 id="安装和使用-Babel"><a href="#安装和使用-Babel" class="headerlink" title="安装和使用 Babel"></a>安装和使用 Babel</h2><blockquote>
<p>ps: 本文将使用Yarn来安装依赖相关npm包，如果不了解Yarn的欢迎阅读公众号专栏<a href="https://segmentfault.com/a/1190000009626901" target="_blank" rel="external">煦涵说Yarn</a>。</p>
</blockquote>
<h3 id="命令行方式运行-babel-cli"><a href="#命令行方式运行-babel-cli" class="headerlink" title="命令行方式运行 babel-cli"></a>命令行方式运行 babel-cli</h3><p><code>babel-cli</code> 的 CLI 是一种在命令行下使用 Babel 编译文件的简单方法。</p>
<h4 id="全局安装"><a href="#全局安装" class="headerlink" title="全局安装"></a>全局安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 全局安装</span></div><div class="line">$ yarn global add babel-cli</div></pre></td></tr></table></figure>
<p>新建一个source.js文件，内容如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line"></div><div class="line">arr = arr.map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> item * index;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(arr);</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 输出结果到控制台</span></div><div class="line">$ babel source.js</div><div class="line"></div><div class="line"><span class="comment"># 输出结果到文件</span></div><div class="line">$ babel source.js --out-file dist.js</div><div class="line">or </div><div class="line">$ babel source.js -o dist.js</div><div class="line"></div><div class="line"><span class="comment"># 输出结果到目录</span></div><div class="line">$ babel /src --out-dir /dist</div><div class="line">or </div><div class="line">$ babel /src -d /dist</div></pre></td></tr></table></figure>
<h4 id="项目内安装-局部安装"><a href="#项目内安装-局部安装" class="headerlink" title="项目内安装(局部安装)"></a>项目内安装(局部安装)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 初始化一个项目package.json</span></div><div class="line">$ mkdir first-babel-proj</div><div class="line">$ <span class="built_in">cd</span> first-babel-proj</div><div class="line">$ yarn init </div><div class="line">$ yarn add babel-cli --dev</div></pre></td></tr></table></figure>
<p>修改package.json，添加如下文本<br><figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  "name": "babel-proj",</div><div class="line">  "version": "1.0.0",</div><div class="line">  "main": "index.js",</div><div class="line">  "license": "MIT",</div><div class="line">  "devDependencies": &#123;</div><div class="line">    "babel-cli": "^6.24.1"</div><div class="line">  &#125;,</div><div class="line"><span class="addition">+  "scripts": &#123;</span></div><div class="line"><span class="addition">+   "build": "babel src -d dist"</span></div><div class="line"><span class="addition">+  &#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ yarn run build</div></pre></td></tr></table></figure></p>
<h3 id="require方式运行-babel-register"><a href="#require方式运行-babel-register" class="headerlink" title="require方式运行 babel-register"></a>require方式运行 babel-register</h3><blockquote>
<p>ps: 这种方法并不适合正式产品环境使用。 在部署到生成环境之前预先编译会更好。 不过用在构建脚本或是其他本地运行的脚本中是非常合适的。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ yarn add babel-register --dev</div></pre></td></tr></table></figure>
<p>新建compile.js文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>(<span class="string">'babel-register'</span>);</div><div class="line"><span class="built_in">require</span>(<span class="string">'./src/source.js'</span>);</div></pre></td></tr></table></figure></p>
<p>运行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">node compile.js</div></pre></td></tr></table></figure></p>
<p>运行结果<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ [0, 2, 6, 12]</div></pre></td></tr></table></figure></p>
<h3 id="编程方式运行-babel-core"><a href="#编程方式运行-babel-core" class="headerlink" title="编程方式运行 babel-core"></a>编程方式运行 babel-core</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ yarn add babel-core --dev</div></pre></td></tr></table></figure>
<p>字符串形式的 JavaScript 代码可以直接使用 <code>babel.transform</code> 来编译。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">babel.transform(<span class="string">"code();"</span>, options);</div><div class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></div></pre></td></tr></table></figure>
<p>如果是文件的话，可以使用异步 api：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">babel.transformFile(<span class="string">"filename.js"</span>, options, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</div><div class="line">  result; <span class="comment">// =&gt; &#123; code, map, ast &#125;</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>或者是同步 api：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">babel.transformFileSync(<span class="string">"filename.js"</span>, options);</div><div class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></div></pre></td></tr></table></figure>
<p>要是已经有一个 Babel AST（抽象语法树）了就可以直接从 AST 进行转换。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">babel.transformFromAst(ast, code, options);</div><div class="line"><span class="comment">// =&gt; &#123; code, map, ast &#125;</span></div></pre></td></tr></table></figure>
<p>更多选项 <a href="https://babeljs.io/docs/usage/api/#options" target="_blank" rel="external">options</a>.</p>
<h2 id="Babel-与-Webpack"><a href="#Babel-与-Webpack" class="headerlink" title="Babel 与 Webpack"></a>Babel 与 Webpack</h2><p>使用 <a href="https://github.com/babel/babel-loader" target="_blank" rel="external">babel-loader</a> 插件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ yarn add bable-loader --dev</div></pre></td></tr></table></figure></p>
<p>webpack.config.js 配置文件增加如下规则：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    test: <span class="regexp">/\.js$/</span>,</div><div class="line">    loader: <span class="string">'babel-loader'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Babel-低版本浏览器兼容"><a href="#Babel-低版本浏览器兼容" class="headerlink" title="Babel 低版本浏览器兼容"></a>Babel 低版本浏览器兼容</h2><p>可参考: </p>
<ul>
<li><a href="https://segmentfault.com/a/1190000009613296" target="_blank" rel="external">煦涵说webpack-IE低版本兼容指南</a>，或者FED实验室公众号文章</li>
<li><a href="https://github.com/xcatliu/react-ie8" target="_blank" rel="external">React - IE低版本兼容</a></li>
</ul>

                </div>
            </div>
            <div class="fedlab-article-con-reprint">
                <p>
                    <span>感谢你的阅读，本文出自</span><a href="https://fedlab-team.github.io/" hidefocus="true">FED实验室</a>，转载时请注明出处，谢谢合作。
                    <br> 格式为：FED实验室（
                    <a href="/2017/09/03/煦涵说Babel/" hidefocus="true">https://fedlab-team.github.io/2017/09/03/煦涵说Babel/</a>）
                </p>
            </div>
            
            <div class="fedlab-article-con-prevnext">
                
                
                <p class="next-page">下一篇: <a href="/2017/09/03/煦涵说Flow/" title="煦涵说Flow" rel="next" hidefocus="true">煦涵说Flow</a></p>
                
            </div>
            
        </div>
    </div>
    <div class="fedlab-sidebar">
        <section class="fedlab-sidebar-qrcode">
            <div class="sec-content">
                <img src="http://www.zuojj.com/wp-content/uploads/2017/05/fedlab_qrcode.jpg">
            </div>
        </section>
        <section class="fedlab-sidebar-favlinks">
            <div class="sec-title">
                <h3>友情链接</h3>
            </div>
            <div class="sec-content">
                <ul>
                    <li><a href="http://fedlab-team.github.io">FED实验室</a></li>
                    <li><a href="http://www.zuojj.com">煦涵</a></li>
                    <li><a href="http://fedlab-team.github.io">FED实验室</a></li>
                    <li><a href="http://www.zuojj.com">煦涵</a></li>
                </ul>
            </div>
        </section>
    </div>
</div>
    <footer class="fedlab-footer">
    <div class="fedlab-footer-inner">
        <div class="fedlab-copyright">
            <p>Copyright © 2015 - 2017 FEDLAB.</p>
        </div>
    </div>
</footer>
    <div class="fedlab-backtop">返回顶部</div>
    <script src="/js/index.js"></script>
</body>

</html>